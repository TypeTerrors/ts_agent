version: "3.9"

services:
  ts_trade:
    build: .
    container_name: ts_trade
    restart: unless-stopped
    environment:
      # --- Core symbol & scheduling ---
      TICKET: "${TICKET:-BTC-USDT}"
      RUN_INTERVAL_MINUTES: "${RUN_INTERVAL_MINUTES:-5}"
      LOG_FILE: "${LOG_FILE:-logs/trading.log}"
      MODEL_STORE_PATH: "${MODEL_STORE_PATH:-models}"
      TRADE_HISTORY_LIMIT: "${TRADE_HISTORY_LIMIT:-5000}"
      BAR_INTERVAL_MINUTES: "${BAR_INTERVAL_MINUTES:-0.5}"
      FEATURE_WINDOW_SIZE: "${FEATURE_WINDOW_SIZE:-48}"
      TRAINING_EPOCHS: "${TRAINING_EPOCHS:-16}"
      TRAINING_BATCH_SIZE: "${TRAINING_BATCH_SIZE:-32}"
      TRAINING_VAL_SPLIT: "${TRAINING_VAL_SPLIT:-0.1}"
      TCN_FILTERS: "${TCN_FILTERS:-64,128,128}"
      TCN_KERNEL: "${TCN_KERNEL:-5}"
      TCN_DROPOUT: "${TCN_DROPOUT:-0.2}"
      RISK_NEUTRAL_ZONE: "${RISK_NEUTRAL_ZONE:-0.05}"
      RISK_VOL_TARGET: "${RISK_VOL_TARGET:-0.015}"
      # KUCOIN_BASE_URL: "https://api.kucoin.com"  # Override KuCoin endpoint if needed
    volumes:
      - ./logs:/app/logs
      - ./models:/app/models
    command: ["node", "dist/index.js"]
